---
## Front matter
lang: ru-RU
title: Лабораторная работа №5. Дискреционное разграничение прав в Linux. Исследование влияния дополнительных атрибутов.
author: |
	Alexander S. Baklashov
institute: |
	RUDN University, Moscow, Russian Federation

date: 08 October, 2022

## Formatting
toc: false
slide_level: 2
theme: metropolis
header-includes: 
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
aspectratio: 43
section-titles: true
---

# Цель работы

Изучение механизмов изменения идентификаторов, применения SetUID- и Sticky-битов. Получение практических навыков работы в консоли с дополнительными атрибутами. Рассмотрение работы механизма
смены идентификатора процессов пользователей, а также влияние бита Sticky на запись и удаление файлов.

# Выполнение лабораторной работы

## Создание программы

Войдите в систему от имени пользователя guest.

![guest](image/1.png){ #fig:001 width=80% }

## Создание программы

Создайте программу simpleid.c: 

![simpleid.c](image/2.png){ #fig:002 width=90% }

## Создание программы

Скомплилируйте программу и убедитесь, что файл программы создан

![Скомплилируем](image/3.png){ #fig:003 width=90% }

## Создание программы

Выполните системную программу id и сравните полученный вами результат с данными предыдущего пункта задания.

![id](image/4.png){ #fig:004 width=70% }

Результаты совпадают.

## Создание программы

Усложните программу, добавив вывод действительных идентификато-
ров.

![Усложним программу](image/5.png){ #fig:005 width=90% }

Получившуюся программу назовите simpleid2.c

## Создание программы

Скомпилируйте и запустите simpleid2.c

![simpleid2.c](image/6.png){ #fig:006 width=90% }

## Создание программы

От имени суперпользователя выполните команды.

chown root:guest /home/guest/simpleid2

chmod u+s /home/guest/simpleid2 

1ая команда меняет владельца, 2ая - атрибуты

![chmod](image/7.png){ #fig:007 width=90% }

## Создание программы

Выполните проверку правильности установки новых атрибутов и смены
владельца файла simpleid2 

![ls](image/8.png){ #fig:008 width=90% }

## Создание программы

Запустите simpleid2 и id 

![id](image/9.png){ #fig:009 width=90% }

Результаты совпадают.

## Создание программы

Проделайте тоже самое относительно SetGID-бита

![SetGID](image/10.png){ #fig:010 width=90% }

## Создание программы

Создайте программу readfile.c

![readfile.c](image/11.png){ #fig:011 width=90% }

## Создание программы

Откомпилируйте её 

![Compile](image/27.png){ #fig:012 width=90% }

## Создание программы

Смените владельца у файла readfile.c (или любого другого текстового файла в системе) и измените права так, чтобы только суперпользователь (root) мог прочитать его, a guest не мог 

![Смена владельца](image/12.png){ #fig:013 width=90% }

## Создание программы

Проверьте, что пользователь guest не может прочитать файл readfile.c.

![Проверка](image/14.png){ #fig:014 width=90% }

## Создание программы

Смените у программы readfile владельца и установите SetU’D-бит 

![Смена владельца](image/15.png){ #fig:015 width=90% }

## Создание программы

Проверьте, может ли программа readfile прочитать файл readfile.c?

![Проверка](image/16.png){ #fig:016 width=90% }

## Создание программы

Проверьте, может ли программа readfile прочитать файл /etc/shadow? 

![Проверка](image/17.png){ #fig:017 width=90% }

Программа может прочитать оба файла.

## Исследование Sticky-бита

Выясните, установлен ли атрибут Sticky на директории /tmp, для чего выполните команду ls -l / | grep tmp 

Атрибут "t" установлен.

![Sticky](image/18.png){ #fig:018 width=90% }

## Исследование Sticky-бита

От имени пользователя guest создайте файл file01.txt в директории /tmp
со словом test 

Просмотрите атрибуты у только что созданного файла и разрешите чтение и запись для категории пользователей «все остальные».

![file01.txt](image/19.png){ #fig:019 width=90% }

## Исследование Sticky-бита

От пользователя guest2 (не являющегося владельцем) попробуйте прочитать файл /tmp/file01.txt

От пользователя guest2 попробуйте дозаписать в файл
/tmp/file01.txt слово test2 командой 

Проверьте содержимое файла командой
cat /tmp/file01.txt

![атрибуты](image/20.png){ #fig:020 width=90% }

## Исследование Sticky-бита

От пользователя guest2 попробуйте записать в файл /tmp/file01.txt слово test3, стерев при этом всю имеющуюся в файле информацию командой 

Проверьте содержимое файла командой
cat /tmp/file01.txt 

![запись в файл](image/21.png){ #fig:021 width=90% }

## Исследование Sticky-бита

От пользователя guest2 попробуйте удалить файл /tmp/file01.txt командой
rm /tmp/file01.txt

![удаление файла](image/22.png){ #fig:022 width=90% }

Удалить файл не удалось

## Исследование Sticky-бита

Повысьте свои права до суперпользователя следующей командой su - и выполните после этого команду, снимающую атрибут t (Sticky-бит) с директории /tmp:
chmod -t /tmp 

Покиньте режим суперпользователя командой
exit

От пользователя guest2 проверьте, что атрибута t у директории /tmp нет:
ls -l / | grep tmp

![Снятие Sticky-бита](image/23.png){ #fig:023 width=90% }

## Исследование Sticky-бита

Повторим предыдущие шаги

![шаги](image/24.png){ #fig:024 width=90% }

## Исследование Sticky-бита

![шаги](image/25.png){ #fig:025 width=90% }

## Исследование Sticky-бита

Повысьте свои права до суперпользователя и верните атрибут t на директорию /tmp

![Возвращение Sticky-бита](image/26.png){ #fig:026 width=90% }

# Выводы

В результате выполнения работы я изучил механизмы изменения идентификаторов, применения
SetUID- и Sticky-битов. Получил практические навыки работы в консоли с дополнительными атрибутами. Рассмотрел работу механизма смены идентификатора процессов пользователей, а также влияние бита Sticky на запись и удаление файлов.